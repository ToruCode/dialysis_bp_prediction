# Dialysis_Bp_Prediction
透析中の血圧を予測するAIモデルの実装とアプリケーション

## 概要
透析中の収縮期血圧・拡張期血圧・脈拍を予測する多出力回帰モデル。

## データ
※プライバシー保護のため数値は改変済み。

## パイプライン
1. 前処理（StandardScaler、train/val/test分割）
2. 多層パーセプトロンによる学習
3. RMSE/MAE/R2評価
4. Permutation Importanceによる解釈

## モデル構造
- Linear(64) → BN → Dropout
- Linear(32) → BN → Dropout
- Linear(3)

## 結果

テストデータにおける評価結果は以下の通りです（元スケール: mmHg / bpm）。

| 指標 | 収縮期血圧 | 拡張期血圧 | 脈拍 |
|------|-------------|-------------|------|
| RMSE | 27.85 mmHg  | 14.17 mmHg  | 3.35 bpm |
| MAE  | 22.77 mmHg  | 11.55 mmHg  | 2.72 bpm |
| R2   | -0.086      | -0.080      | -0.012 |

現時点では、R2が全て負の値であるため、平均値による予測を上回る性能には至っていません。

---

## 解釈と考察

本モデルでは、除水量や体重変化などの特徴量を用いて透析中の血圧と脈拍を予測しようとしましたが、  
現状では学習データと検証データでの関係性が十分に学習できていない可能性があります。

考えられる要因：
- データ数が比較的少ない（数百例）
- 特徴量と目的変数の関係が単純線形ではない
- 透析中の血圧変動が多因子性であり、追加の臨床情報が必要

---

## 今後の改善アイデア

- 透析中の時系列データを扱うモデル（LSTM等）への拡張
- より多くの事例で学習を行う
- 病態情報や薬剤情報など追加の特徴量を検討
